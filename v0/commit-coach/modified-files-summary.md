# 修正ファイル一覧

このプロジェクトで直接修正を加えたファイルの一覧と、各ファイルの修正内容の概要です。

## 折りたたみ機能の修正

### 1. `components/task-group.tsx`

- useEffect の依存配列から `isExpanded` を削除し、タスク数が0から1以上になった場合のみ自動展開するように修正
- プロジェクトヘッダーの `TaskItemWithMenu` に `expanded={isExpanded}` プロパティを追加
- `useRef` を使用して前回のタスク数を記録し、タスク数の変化を検出
### 2. `components/task-item-with-menu.tsx`

- ホバー時のカクつき問題を解決するために、React の状態管理（`isHovered`）を削除
- CSS のみでホバー効果を実装（`group` と `group-hover` クラスを使用）
- メニュー部分に固定幅を設定してレイアウトシフトを防止
- トランジション効果を追加して滑らかな表示/非表示を実現
- 展開/折りたたみボタンのイベント処理を改善

### 3. `app/projects/page.tsx`

- プロジェクトの展開/折りたたみ状態を正しく管理するように修正
- `toggleProjectExpanded` 関数と `toggleTaskExpanded` 関数の実装を確認

## サブタスクの時間管理機能（コメントアウト状態）

### 4. `lib/dashboard-utils.ts`

- `SubTask` インターフェースに `startTime` と `endTime` フィールドを追加（コメントアウト）
- 将来的に必要になった場合に備えて、サブタスクの時間管理機能を実装

### 5. `components/hierarchical-task-item.tsx`

- サブタスク用の時間表示機能を追加（コメントアウト）
- `isSubtask` プロパティを追加して、サブタスク専用の時間表示スタイルを定義

### 6. `app/dashboard/page.tsx`

- サブタスクの時間変更ハンドラー `handleSubtaskTimeChange` を追加（コメントアウト）
- サブタスク表示部分に時間管理機能を追加（コメントアウト）

### 7. `app/projects/project-template.tsx`

- `SubTask` インターフェースに時間管理フィールドを追加（コメントアウト）
- サブタスクの時間編集機能 `updateSubtaskTime` を追加（コメントアウト）

## 修正の目的

1. **折りたたみ機能の修正**：
   - プロジェクトとタスクの折りたたみ/展開機能が正しく動作するように修正
   - 折りたたみボタンが表示されない問題を解決
   - 折りたたみ後に自動的に展開されてしまう問題を解決

2. **パフォーマンス改善**：
   - サブタスクをホバーした際のカクつき問題を解決
   - 不要な再レンダリングを削減
   - CSS のみでホバー効果を実装してパフォーマンスを向上

3. **将来の拡張性**：
   - サブタスクの時間管理機能を実装し、コメントアウトして将来的に必要になった場合に備える
   - 機能を有効化するには、コメントを解除するだけで良いように設計
